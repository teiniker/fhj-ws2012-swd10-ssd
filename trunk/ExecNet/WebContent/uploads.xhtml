<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:p="http://primefaces.org/ui">

<ui:composition template="layout/_template_master.xhtml">

	<ui:define name="title">ExecNet: Uploads</ui:define>
	<ui:define name="content">

		<f:view>
			<div id="tasks">
				<c:if test="#{user.isLoggedIn() == true}">

					<h:form>
						
                       <p:fileUpload fileUploadListener="#{documentBean.upload}"
                       multiple="true"
                       label="#{msg.document_upload_browse}" uploadLabel="#{msg.document_upload_upload}" cancelLabel="#{msg.document_upload_cancel}" 
                       description="#{msg.document_upload_description}" 
                       allowTypes="/(\.|\/)(gif|jpe?g|png)$/" 
                       update="docList"
                       />                        
                        <p:outputPanel id="docList">
                        <table>
                            <tr>
                                <td><b>#{msg.document_name}</b></td>
                                <td><b>#{msg.document_owner}</b></td>
                                <td><b>#{msg.document_date}</b></td>
                                <td><b></b></td>
                            </tr>

                            <ui:repeat var="item" value="#{documentBean.getAll()}">
                                <tr>
        							<td>#{item.name}</td>
        							<td>#{item.owner.username}</td>
        							<td>#{item.dateCreated}</td>
             
                                    <td nowrap="true">
           
                                        <ui:fragment>                                       
                                            <h:commandButton rendered="#{item.owner.id eq user.id}"
                                            action="#{documentBean.delete(item.id)}" value="#{msg.document_delete}" />
                                        </ui:fragment>
                                    </td>
                                </tr>
                            </ui:repeat>
                        </table>
                      </p:outputPanel>
                    </h:form>
				</c:if>

				<c:if test="#{user.isLoggedIn() == false}">#{msg.global_signinfirst}</c:if>
			</div>
		</f:view>
	</ui:define>
</ui:composition>
</html>