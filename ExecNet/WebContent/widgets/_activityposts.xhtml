<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html
    xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:c="http://java.sun.com/jsp/jstl/core">
    <body>
    	<div class="widget" id="activity">
        	<h:form id="newActivity">
            	<table>
            		<tr><th>#{msg.activitys_add}</th></tr>
               		<tr>
            		   	<td>
            		   		<h:inputText id="entry" 
            		   			value="#{activityPostBean.entry}"
            		   			required="true" />
            		   	</td>
               			<td>
            		   		<h:commandButton 
            		   			action="#{activityPostBean.addNow()}"
            		   			value="#{msg.post_submit}"/>
            		   	</td>
            		</tr>
            		<tr>
            			<td colspan="3">
               				<h:messages style="color: Red;"/>
               			</td>
               		</tr>						   	
            	</table>   	
           	</h:form>
           	<h:form>
            	<table>
            		<tr>
            			<th>#{msg.global_activitys}</th>
            		</tr>				
            		<ui:repeat var="item" value="#{activityPostBean.getAllByUser()}">
            			<tr>
            				<td>on #{item.getPostDate()}, #{item.author.getUsername()} wrote: </td> 
            				<td>#{item.entry}</td>
            				<td>
                                <c:if test="#{activityPostBean.isAuthor(item)}">
            						<h:commandButton action="#{activityPostBean.delete}"
            							value="#{msg.post_delete}">
                                        <ui:param name="post" value="#{item}"></ui:param>
                                    </h:commandButton>
                                    <h:commandButton action="#{activityPostBean.edit}"
                                        value="#{msg.post_delete}">
                                        <ui:param name="post" value="#{item}"></ui:param>
                                    </h:commandButton>
                                 </c:if>
            				</td>
            			</tr>
                        <tr>
                            <ui:include src="_comments.xhtml">
                                <ui:param name="post" value="#{item}" />
                            </ui:include>
                        </tr>
            		</ui:repeat>
            	</table>
        	</h:form>
        </div>
    </body>			
</html>